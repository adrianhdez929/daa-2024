## Reducción formal del VRP clásico al HFVRP
### Definición del problema VRP clásico
El Vehicle Routing Problem (VRP) clásico se define típicamente de la siguiente manera:

**Grafo de localidades**: Tenemos un conjunto de nodos $V = \{0,1,2,\dots,n\}$ donde $0$ representa el depósito (centro de distribución) y $\{1,\dots,n\}$ son los clientes (puntos de entrega). Existe un conjunto de aristas que conectan los nodos, con costos de viaje conocidos $c(i,j)$ para cada par de nodos (por ejemplo, distancias o tiempos entre localidades).

**Demanda de clientes**: Cada cliente $i \in \{1,\dots,n\}$ tiene una demanda $d_i > 0$ de cierta mercancía (en el VRP clásico asumimos que la demanda total de cada ruta no excede la capacidad del vehículo).

**Flota de vehículos homogénea**: Se dispone de $K$ vehículos idénticos, todos con la misma capacidad $Q$. Todos los vehículos comienzan en el depósito $0$ y deben regresar al depósito al finalizar su ruta.

**Restricciones de capacidad**: La suma de las demandas de los clientes atendidos por un mismo vehículo no puede exceder $Q$ (capacidad del vehículo). Usualmente, además, cada cliente debe ser atendido exactamente una vez por un vehículo (no se permiten entregas fraccionadas entre vehículos en la formulación clásica).

**Objetivo**: Encontrar un conjunto de rutas (una ruta para cada vehículo usado) tal que: (1) cada cliente sea visitado por exactamente un vehículo, (2) ningún vehículo exceda su capacidad $Q$, (3) todos los vehículos inician y terminan en el depósito, y (4) se minimice el costo total de transporte (por ejemplo, la suma de costos/distancias recorridas por todos los vehículos).

El VRP es un problema notoriamente difícil, se sabe que es NP-hard porque generaliza al problema del viajante (TSP) como un caso particular​. Esto implica que no se conoce ningún algoritmo de tiempo polinomial para resolver el VRP en general (a menos que $P=NP$).

### Definición del problema HFVRP (flota heterogénea)
El Heterogeneous Fleet VRP (HFVRP) extiende el VRP permitiendo una flota con múltiples tipos de vehículos con características diferentes. Formalmente, una instancia de HFVRP incluye:
**Nodos y demandas**: El mismo conjunto de nodos $V = \{0,1,\dots,n\}$ con un depósito $0$ y clientes $1,\dots,n$ con demandas $d_i$, y la misma matriz de costos de viaje $c(i,j)$ entre nodos. (El HFVRP generalmente se considera sobre el mismo tipo de grafo que el VRP).

**Flota heterogénea**: Un conjunto de tipos de vehículos $T = \{1,2,\dots,m\}$. Cada tipo $j\in T$ tiene una capacidad $Q_j$ (máxima carga que puede llevar) y un costo asociado. El costo puede descomponerse, por ejemplo, en un costo por distancia recorrida (o tiempo) y/o un costo fijo por usar un vehículo de ese tipo. Adicionalmente, puede haber una cantidad limitada $M_j$ de vehículos disponibles de cada tipo $j$ (flota fija heterogénea). Todos los vehículos comienzan y terminan en el depósito (suponiendo un solo depósito; si hubiera varios depósitos, sería una extensión de múltiples depósitos).

**Restricciones**: Cada ruta asignada a un vehículo de tipo $j$ no puede sobrepasar la capacidad $Q_j$. Cada cliente debe ser atendido exactamente una vez por algún vehículo (como en VRP). No se puede usar más vehículos de cada tipo que la disponibilidad $M_j$.

**Objetivo**: Diseñar rutas para un subconjunto de vehículos (posiblemente de distintos tipos) de modo que se satisfagan todas las demandas (cada cliente atendido) respetando las capacidades y disponibilidades, y minimizando el costo total de operación (suma de costos de transporte de todas las rutas, incluyendo costos por distancia y cualquier costo fijo por uso de vehículos).

Es claro que el HFVRP es una generalización del VRP: si todos los vehículos tienen el mismo tipo (misma capacidad y costos), el HFVRP se reduce al VRP clásico. De hecho, el HFVRP incluye al VRP como caso especial, por lo que también es NP-hard (NP-difícil)​. La diferencia clave es que en HFVRP debemos decidir también qué tipo de vehículo asignar a cada ruta, agregando otra capa de decisión. Los vehículos más grandes pueden llevar más demanda pero quizá implican mayor costo, mientras que vehículos más pequeños son más baratos pero podrían requerir más viajes. Esta heterogeneidad aumenta la complejidad del problema en comparación con el VRP homogéneo.

### Reducción de una instancia VRP a una instancia HFVRP
Dada una instancia del VRP clásico, podemos transformarla en una instancia equivalente de HFVRP de forma directa:
- Conjunto de nodos y demandas: Mantenemos exactamente los mismos clientes, el mismo depósito y las mismas demandas $d_i$ para cada cliente $i$. También conservamos la misma matriz de costos $c(i,j)$ entre nodos que tenía la instancia VRP.
- Definición de tipos de vehículo: Introducimos un conjunto de tipos de vehículos $T = \{1\}$ con un único tipo de vehículo. A este tipo único le asignamos capacidad $Q_1 = Q$, donde $Q$ es la capacidad común de los vehículos en el VRP original. Definimos los costos de este tipo de manera consistente con el VRP original (por ejemplo, costo por unidad de distancia igual al costo unitario en VRP, y si en VRP no había un costo fijo por vehículo, podemos considerar costo fijo $0$ para este tipo).
- Disponibilidad de vehículos: Establecemos $M_1 = K$, donde $K$ es el número de vehículos idénticos en la instancia VRP original. Es decir, disponemos de $K$ vehículos del tipo 1 en la instancia HFVRP.
- Restricciones y objetivo: Las restricciones de capacidad y asignación se mantienen igual (cada ruta con un vehículo tipo 1 puede cubrir hasta $Q$ de demanda, y cada cliente sólo puede aparecer en una ruta). El objetivo sigue siendo minimizar el costo total de las rutas.

Esta construcción produce una instancia de HFVRP que esencialmente reproduce el mismo espacio de soluciones que la instancia VRP original. En efecto, dado que solo hay un tipo de vehículo en la instancia HFVRP resultante, todas las soluciones posibles involucran únicamente vehículos de tipo 1, los cuales se comportan exactamente igual que los vehículos homogéneos del VRP. Cualquier solución factible del VRP original (un conjunto de rutas que cubren todos los clientes con $K$ vehículos de capacidad $Q$) es también una solución factible de la nueva instancia HFVRP (usando $K$ vehículos del tipo 1 con capacidad $Q$). Inversamente, cualquier solución factible de la instancia HFVRP construida debe usar únicamente vehículos del tipo 1 y por lo tanto corresponde a una solución válida del VRP original.
Además, los costos de cualquier ruta o conjunto de rutas serán idénticos en ambas instancias, ya que usamos la misma matriz de costos y no introdujimos costos adicionales. Por tanto, una solución óptima del VRP original corresponde directamente a una solución óptima de la instancia HFVRP construida, con el mismo costo total. La transformación descrita se realiza en tiempo polinomial (de hecho, lineal) con respecto al tamaño de la entrada, pues solo consiste en reetiquetar la flota con un tipo de vehículo y copiar los datos.
Conclusión: Hemos reducido formalmente VRP a HFVRP mostrando que dada cualquier instancia de VRP podemos construir en tiempo polinomial una instancia de HFVRP cuyo conjunto de soluciones corresponde uno a uno con las soluciones de la instancia VRP. Esto prueba que HFVRP es al menos tan difícil como VRP. Dado que VRP es NP-hard, HFVRP también lo es​. La diferencia clave es que HFVRP permite vehículos con diferentes capacidades y costos, pero el VRP aparece como el caso especial donde todos los vehículos comparten la misma capacidad y costo. En términos de complejidad, agregar heterogeneidad no simplifica el problema; al contrario, mantiene (o aumenta) la dificultad combinatoria al tener que elegir entre diferentes tipos de vehículos en las rutas.

### Equivalencia entre HFVRP y nuestro problema 
Supongamos ahora nuestro problema de transporte. En esencia, este problema describe una situación de distribución de ayuda que podemos modelar de manera muy similar al HFVRP. A continuación, establecemos la correspondencia directa entre los elementos del HFVRP y los de dicho escenario humanitario:
- **Depósitos (centros de suministro)**: En el escenario humanitario, existen uno o varios depósitos o almacenes donde se acopian los recursos de ayuda (agua, víveres, medicamentos, etc.). Denotemos por $D$ el conjunto de depósitos disponibles. En la correspondencia con HFVRP, cada depósito en $D$ corresponde al depósito (o depósitos) del modelo de enrutamiento. (Si en el HFVRP original solo se considera un depósito central, podemos asimilar todos los suministros a un único depósito central en el escenario; si hay varios depósitos, esto equivale a una extensión de VRP de múltiples depósitos, pero sigue siendo un caso de HFVRP).
- **Zonas afectadas con demanda**: El escenario humanitario incluye un conjunto de zonas afectadas que requieren ayuda (por ejemplo, comunidades o localidades golpeadas por un desastre). Podemos denotar este conjunto de destinos como $Z = \{1,2,\dots,n\}$, donde cada zona $i$ tiene una demanda específica $d_i$ de recursos (cantidad de agua, kits de emergencia, etc. necesarios). Esta corresponde exactamente al conjunto de clientes con demanda en el HFVRP: cada zona afectada $i$ equivale a un “cliente” que debe ser atendido, con la demanda $d_i$ a satisfacer.
- **Flota heterogénea de vehículos**: En la logística humanitaria suele haber disponibles varios vehículos de transporte (camiones, camionetas, helicópteros, etc.) con diferentes capacidades de carga y costos operativos. Esto se corresponde directamente con la flota heterogénea del HFVRP. Podemos definir un conjunto de tipos de vehículo $T = \{1,2,\dots,m\}$ en el escenario humanitario, donde cada tipo $j$ representa un vehículo específico (o una categoría de vehículos) con capacidad $Q_j$ (por ejemplo, camión grande capaz de llevar $Q_j$ palés de suministros) y un costo de operación (por km recorrido, o un costo fijo por usar ese vehículo). Además, puede haber un límite $M_j$ en la cantidad disponible de vehículos de cada tipo (por ejemplo, $M_1=2$ camiones grandes, $M_2=5$ camionetas, etc.). Esto refleja exactamente la flota heterogénea del HFVRP: cada tipo $j$ del HFVRP tiene su análogo en el escenario (mismas capacidades y costos), y la disponibilidad $M_j$ coincide.
- **Costos de transporte**: En el escenario de nuestro problema, podemos asociar un costo de transporte a cada recorrido entre dos puntos, normalmente proporcional a la distancia, tiempo o dificultad del trayecto. Esto define una matriz de costos $c(u,v)$ entre cualquier par de ubicaciones $u$, $v$ (ya sea entre depósitos y zonas, o entre dos zonas). Este conjunto de costos de transporte es idéntico a la matriz de costos que usaríamos en HFVRP para esos nodos. La optimización del costo total de transporte en el escenario (por ejemplo, minimizando combustible, tiempo o dinero gastado) corresponde directamente al objetivo de minimización de costo en HFVRP.
- **Rutas de entrega válidas (restricciones)**: Una solución factible en el escenario humanitario consiste en planificar rutas para varios vehículos que parten de los depósitos con recursos, visitan ciertas zonas para entregar ayuda, y regresan al depósito (o terminan cuando la entrega concluye, dependiendo del modelo). Las restricciones de selección de casos válidos mencionadas por el usuario se refieren a las condiciones que hacen que un conjunto de entregas en una ruta sea válido: esto incluye principalmente las restricciones de capacidad y de cobertura, y la disponibilidad de vehículos, que son equivalentes a las restricciones del HFVRP:
  - Cada vehículo no puede transportar más recursos de los que permite su capacidad. Es decir, la suma de demandas de las zonas atendidas por una ruta en un vehículo de tipo $j$ no puede exceder $Q_j$. (Esta es la misma restricción de capacidad del HFVRP).
  - Cada zona afectada debe ser atendida exactamente una vez en la solución final. En otras palabras, las rutas seleccionadas deben cubrir todas las zonas $Z$ y ninguna zona puede aparecer en dos rutas distintas. Esto asegura que se satisface toda la demanda de cada zona y evita duplicaciones, correspondiendo a la restricción de que cada cliente es visitado una vez en VRP/HFVRP.
  - No se puede utilizar más vehículos de cada tipo que los disponibles. Por ejemplo, si solo hay $M_j$ vehículos del tipo $j$, a lo sumo $M_j$ rutas podrán usar un vehículo de ese tipo. Esta condición refleja la disponibilidad limitada de cada tipo de vehículo en la flota (idéntica a la del HFVRP).
  - Todas las rutas comienzan en algún depósito (donde se cargan los recursos) y usualmente retornan a un depósito tras realizar las entregas. Esto corresponde al supuesto de inicio/fin en depósito del HFVRP. (En contextos abiertos podría no requerirse retorno, pero asumimos el caso estándar cerrado para equivalencia directa).
- **Objetivo de optimización**: El objetivo en el escenario humanitario es minimizar el costo total de la operación de transporte al distribuir los recursos. Esto incluye minimizar las distancias recorridas por los vehículos (y posiblemente el número de vehículos usados, si consideramos costos fijos por vehículo). Este objetivo coincide exactamente con el objetivo del HFVRP de minimizar el costo total de las rutas. Cada ruta en el escenario tiene un costo (por distancia recorrida y vehículo empleado) y queremos que la suma de costos de todas las rutas sea mínima, al mismo tiempo que se satisfacen todas las demandas.

Dados los puntos anteriores, podemos ver que existe una correspondencia uno a uno entre cualquier instancia de HFVRP y una instancia del problema humanitario descrito: simplemente reinterpretamos los “clientes” como zonas afectadas, el “depósito” como centro de suministro, y los “vehículos heterogéneos” de la flota como los medios de transporte disponibles en la respuesta humanitaria. Cualquier solución factible en el contexto humanitario (una asignación de vehículos a rutas que cubren las zonas) es también una solución factible de HFVRP con los mismos datos, y viceversa. En términos formales, podemos reducir HFVRP al problema de transporte humanitario definiendo la transformación de instancia de la siguiente manera:
Dada una instancia de HFVRP con depósito(s) $D$, tipos de vehículo $T$ (capacidades $Q_j$, costos, y disponibilidad $M_j$), clientes $\{1,\dots,n\}$ con demandas $d_i$, y matriz de costos $c(i,j)$, construimos una instancia del problema humanitario donde: los depósitos de HFVRP se toman como los depósitos $D$ en el escenario; cada cliente $i$ se convierte en una zona afectada con demanda $d_i$; cada tipo de vehículo $j\in T$ se convierte en un tipo de medio de transporte con la misma capacidad $Q_j$ y costos operativos, disponiendo de $M_j$ unidades de ese tipo; y la distancia o costo entre dos puntos en el escenario se define igual que $c(i,j)$ en la instancia HFVRP. Las restricciones de ruteo (capacidad, cobertura única de cada zona, límite de vehículos por tipo) se incluyen tal cual.
Esta transformación es polinomial en el tamaño de la instancia (de hecho, esencialmente copiamos los datos añadiendo la interpretación humanitaria), y asegura que hay una equivalencia directa: cualquier solución que minimice costos y satisfaga demandas en la instancia humanitaria corresponde a una solución óptima del HFVRP original, y viceversa. Por lo tanto, hemos establecido una equivalencia entre el HFVRP y el problema de transporte de recursos humanitario formulado por el usuario.

### Complejidad computacional y NP-dureza del problema humanitario
Dado que el HFVRP es NP-hard, esta equivalencia significa que el problema de transporte de recursos en escenarios humanitarios del usuario es al menos tan difícil como el HFVRP. En términos de teoría de la complejidad, el problema humanitario heredó la dificultad combinatoria del HFVRP: cualquier algoritmo capaz de resolver eficientemente (en tiempo polinomial) el problema humanitario podría aplicarse, vía la reducción descrita, a resolver instancias arbitrarias de HFVRP (y por ende de VRP y TSP). Esto indica que el problema del usuario es NP-hard, ya que resolverlo implica resolver un problema NP-hard subyacente.

En conclusión, hemos demostrado con rigor que el problema de transporte de recursos en escenarios humanitarios formulado por el usuario es tan difícil como el HFVRP, abarcando los mismos elementos esenciales (depósitos, flota heterogénea con diferentes capacidades/costos, demandas de destinos, minimización de costo, y restricciones de capacidad/asignación). Esto implica que no existe un método conocido para encontrar la solución óptima en tiempo polinomial en el peor caso, salvo que se produzca un avance mayor en la teoría de la complejidad (es decir, a menos que $P=NP$). En otras palabras, el problema del usuario es NP-difícil, al igual que el HFVRP y el VRP, lo que justifica la necesidad de técnicas heurísticas o aproximadas para abordarlo en instancias de tamaño grande.
